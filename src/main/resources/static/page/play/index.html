<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Game</title>
<script type="text/javascript" src="/js/jquery-3.3.1.min.js"></script>
</head>
<body>
哈哈哈
<a id="create-room" href="javascript:;">创建房间</a>
</body>
</html>
<script type="text/javascript">
//定义麻将游戏数据结构
var param   = {
	code : 0,   //标记
	uid  : 0,
	data : null    //具体数据结构
}
var uuid = 0;
$.ajax({
	url : '/user/uuid',
	type : 'post',
	async: false,//使用同步的方式,true为异步方式
	data : {'client':'mj'},
	success : function(response){
	    if(response.code == 1) {
	    	uuid = response.data.uuid;
	    	param.uid = uuid;
	    	signal();
	    } else {
	    	alert(response.msg);
	    	window.location.href="/play/login";
	    }
	}
});

function signal(){
	var socket = new WebSocket('ws://' + window.location.host + '/mj');
	

	//Add an event listener for when a connection is open
	socket.onopen = function() {
	     console.log('WebSocket connection opened. Ready to send messages.');
	     //step1,用户注册
	     param.code = 1;
	     param.data = uuid;
	     var data = JSON.stringify(param);
	     socket.send(data);
	};

	//Add an event listener for when a message is received from the server
	socket.onmessage = function(message) {
	     //解析message中的数据，判断类型
	};
	
	
	//页面上操作主体方法
	//step1创建房间
	$("#create-room").click(function(){
		param.code = 2;
		//先默认基础价格为1元
		//初始化参数 people代表玩的人数
		//amount代表玩的金额
	    param.data = {
			people : 3, 
			amount : 1
		};
	    var data = JSON.stringify(param);
	    socket.send(data);
	});
}




</script>